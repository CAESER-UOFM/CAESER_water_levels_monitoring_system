(()=>{var e={};e.id=892,e.ids=[892],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},470:e=>{"use strict";e.exports=require("sql.js")},964:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(6990),a(2029),a(5866);var s=a(3191),l=a(8716),r=a(7922),i=a.n(r),n=a(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["wells",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,6990)),"/Users/bmac/Documents/GitHub/water_levels_monitoring_(for_external_edits)/tools/Visualizer/src/app/wells/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,2029)),"/Users/bmac/Documents/GitHub/water_levels_monitoring_(for_external_edits)/tools/Visualizer/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/bmac/Documents/GitHub/water_levels_monitoring_(for_external_edits)/tools/Visualizer/src/app/wells/[id]/page.tsx"],m="/wells/[id]/page",u={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/wells/[id]/page",pathname:"/wells/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6468:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},3074:()=>{},2769:(e,t,a)=>{Promise.resolve().then(a.bind(a,2569))},5047:(e,t,a)=>{"use strict";var s=a(7389);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},2569:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(326),l=a(7577),r=a(5047),i=a(3830),n=a(9609);function o({databaseId:e,onWellSelected:t}){let[a,r]=(0,l.useState)([]),[o,d]=(0,l.useState)(!0),[c,m]=(0,l.useState)(null),[u,x]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(void 0),[w,f]=(0,l.useState)("well_number"),[_,j]=(0,l.useState)("asc"),[v,y]=(0,l.useState)(1),[N,E]=(0,l.useState)(1),[k,C]=(0,l.useState)(0),L=(0,l.useMemo)(()=>Array.from(new Set(a.map(e=>e.well_field).filter(Boolean))).sort(),[a]),D=(0,l.useCallback)(async(t={})=>{try{d(!0),m(null);let a=i.f4.getDatabase(e);if(!a)throw Error("Database not available");let s=await a.getWells({...t,page:v,limit:20});if(s.success&&s.data)r(s.data),E(s.pagination.totalPages),C(s.pagination.total);else throw Error(s.error||"Failed to load wells")}catch(e){console.error("Error loading wells:",e),m(e instanceof Error?e.message:"Failed to load wells"),r([])}finally{d(!1)}},[e,v,20]),S=(0,l.useCallback)(e=>{x(e)},[]),R=(0,l.useCallback)(e=>{p(e)},[]),O=(0,l.useCallback)(e=>{b(""===e?void 0:"true"===e)},[]),T=(0,l.useCallback)(e=>{w===e?j(e=>"asc"===e?"desc":"asc"):(f(e),j("asc"))},[w]),W=(0,l.useCallback)(e=>{y(e)},[]),A=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"No data",z=e=>w!==e?s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}):"asc"===_?s.jsx("svg",{className:"w-4 h-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 15l4-4 4 4"})}):s.jsx("svg",{className:"w-4 h-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 9l-4 4-4-4"})});return c?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("svg",{className:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Wells"}),s.jsx("p",{className:"text-gray-600 mb-4",children:c}),s.jsx("button",{onClick:()=>D(),className:"btn-primary",children:"Try Again"})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"card",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Well Browser"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Wells"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("input",{type:"text",value:u,onChange:e=>S(e.target.value),placeholder:"Well number, CAE, field...",className:"input-field pl-10"}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Well Field"}),(0,s.jsxs)("select",{value:h,onChange:e=>R(e.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"All Fields"}),L.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Availability"}),(0,s.jsxs)("select",{value:void 0===g?"":g.toString(),onChange:e=>O(e.target.value),className:"input-field",children:[s.jsx("option",{value:"",children:"All Wells"}),s.jsx("option",{value:"true",children:"With Data"}),s.jsx("option",{value:"false",children:"No Data"})]})]}),s.jsx("div",{className:"flex items-end",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:k})," wells found",N>1&&(0,s.jsxs)("span",{className:"block text-xs",children:["Page ",v," of ",N]})]})})]})]}),(0,s.jsxs)("div",{className:"card",children:[o?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(n.T,{size:"large"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading wells..."})]}):0===a.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Wells Found"}),s.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria or filters"})]}):s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 mobile-touch-target",onClick:()=>T("well_number"),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Well Number"}),z("well_number")]})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 mobile-touch-target",onClick:()=>T("cae_number"),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"CAE Number"}),z("cae_number")]})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Field"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Readings"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 mobile-touch-target",onClick:()=>T("last_reading_date"),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("span",{children:"Last Reading"}),z("last_reading_date")]})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>t(e),children:[s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.well_number}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-700",children:e.cae_number||"—"}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-700",children:e.well_field||"—"}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("span",{className:"font-medium",children:e.total_readings||0}),(0,s.jsxs)("div",{className:"flex space-x-1",children:[e.has_transducer_data&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",title:"Has transducer data",children:"T"}),e.has_manual_readings&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",title:"Has manual readings",children:"M"}),e.has_telemetry_data&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",title:"Has telemetry data",children:"Tel"})]})]})}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-700",children:A(e.last_reading_date)}),s.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm",children:s.jsx("button",{onClick:a=>{a.stopPropagation(),t(e)},className:"text-primary-600 hover:text-primary-800 font-medium mobile-touch-target",children:"View Data →"})})]},e.well_number))})]})}),N>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-200 bg-gray-50 px-4 py-3 sm:px-6",children:[(0,s.jsxs)("div",{className:"flex justify-between sm:hidden",children:[s.jsx("button",{onClick:()=>W(v-1),disabled:1===v,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),s.jsx("button",{onClick:()=>W(v+1),disabled:v===N,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,s.jsxs)("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[s.jsx("div",{children:(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing"," ",s.jsx("span",{className:"font-medium",children:(v-1)*20+1})," ","to"," ",s.jsx("span",{className:"font-medium",children:Math.min(20*v,k)})," ","of"," ",s.jsx("span",{className:"font-medium",children:k})," ","results"]})}),s.jsx("div",{children:(0,s.jsxs)("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[s.jsx("button",{onClick:()=>W(v-1),disabled:1===v,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z",clipRule:"evenodd"})})}),Array.from({length:Math.min(5,N)},(e,t)=>{let a=t+1;return s.jsx("button",{onClick:()=>W(a),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${v===a?"z-10 bg-primary-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`,children:a},a)}),s.jsx("button",{onClick:()=>W(v+1),disabled:v===N,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z",clipRule:"evenodd"})})})]})})]})]})]})]})}function d(){let e=(0,r.useParams)(),t=(0,r.useRouter)(),a=e.id,[i,d]=(0,l.useState)(null),[c,m]=(0,l.useState)(!0),[u,x]=(0,l.useState)(null),h=(0,l.useCallback)(e=>{t.push(`/wells/${a}/plot/${e.well_number}`)},[a,t]),p=(0,l.useCallback)(()=>{t.push("/")},[t]);return c?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(n.T,{size:"large"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"Loading database..."})]})}):u?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md mx-auto px-4",children:[s.jsx("svg",{className:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"})}),s.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Database Error"}),s.jsx("p",{className:"text-gray-600 mb-4",children:u}),s.jsx("button",{onClick:p,className:"btn-primary",children:"← Back to Databases"})]})}):i?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:p,className:"p-2 text-gray-600 hover:text-gray-900 transition-colors mobile-touch-target",title:"Back to databases",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:i.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[i.wellsCount," wells available"]})]})]}),(0,s.jsxs)("div",{className:"hidden sm:flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})}),s.jsx("span",{children:"Database"})]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsx(o,{databaseId:a,onWellSelected:h})})]}):null}},9609:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var s=a(326);function l({size:e="medium",className:t=""}){return s.jsx("div",{className:`loading-spinner ${{small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12"}[e]} ${t}`})}},3830:(e,t,a)=>{"use strict";a.d(t,{TD:()=>n,f4:()=>d});var s=a(470),l=a.n(s);let r=null;async function i(){if(!r)try{r=await l()({locateFile:e=>`https://sql.js.org/dist/${e}`})}catch(e){throw console.error("Failed to initialize sql.js:",e),Error("Database initialization failed")}}class n{constructor(e){this.arrayBuffer=e,this.db=null,this.initialized=!1}async initialize(){if(!this.initialized){if(await i(),!r)throw Error("SQL.js not initialized");try{this.db=new r.Database(new Uint8Array(this.arrayBuffer)),this.initialized=!0,await this.validateSchema()}catch(e){throw console.error("Failed to open database:",e),Error("Invalid database file")}}}async validateSchema(){if(!this.db)throw Error("Database not initialized");let e=this.db.prepare('SELECT name FROM sqlite_master WHERE type="table"'),t=[];for(;e.step();){let a=e.getAsObject();t.push(a.name)}for(let a of(e.free(),["wells","water_level_readings"]))if(!t.includes(a))throw Error(`Required table '${a}' not found in database`)}async getWells(e={}){if(!this.db)throw Error("Database not initialized");let{search:t="",field:a="",hasData:s,page:l=1,limit:r=50,sortBy:i="well_number",sortOrder:n="asc"}=e,o=`
      SELECT 
        w.*,
        COUNT(wlr.id) as total_readings,
        MAX(wlr.timestamp_utc) as last_reading_date,
        CASE WHEN COUNT(mr.id) > 0 THEN 1 ELSE 0 END as has_manual_readings,
        CASE WHEN COUNT(wlr.id) > 0 THEN 1 ELSE 0 END as has_transducer_data
      FROM wells w
      LEFT JOIN water_level_readings wlr ON w.well_number = wlr.well_number
      LEFT JOIN manual_readings mr ON w.well_number = mr.well_number
      WHERE 1=1
    `,d=[];if(t){o+=" AND (w.well_number LIKE ? OR w.cae_number LIKE ? OR w.well_field LIKE ?)";let e=`%${t}%`;d.push(e,e,e)}a&&(o+=" AND w.well_field = ?",d.push(a)),void 0!==s&&(s?o+=" AND COUNT(wlr.id) > 0":o+=" AND COUNT(wlr.id) = 0"),o+=" GROUP BY w.well_number",["well_number","cae_number","last_reading_date"].includes(i)&&(o+=` ORDER BY ${i} ${n.toUpperCase()}`),o+=" LIMIT ? OFFSET ?",d.push(r,(l-1)*r);try{let e=this.db.prepare(o);e.bind(d);let s=[];for(;e.step();){let t=e.getAsObject();s.push(this.mapRowToWell(t))}e.free();let i=`
        SELECT COUNT(DISTINCT w.well_number) as total
        FROM wells w
        LEFT JOIN water_level_readings wlr ON w.well_number = wlr.well_number
        WHERE 1=1
      `,n=[];if(t){i+=" AND (w.well_number LIKE ? OR w.cae_number LIKE ? OR w.well_field LIKE ?)";let e=`%${t}%`;n.push(e,e,e)}a&&(i+=" AND w.well_field = ?",n.push(a));let c=this.db.prepare(i);c.bind(n),c.step();let m=c.getAsObject().total;return c.free(),{success:!0,data:s,pagination:{page:l,limit:r,total:m,totalPages:Math.ceil(m/r)}}}catch(e){throw console.error("Error fetching wells:",e),Error("Failed to fetch wells data")}}async getWell(e){if(!this.db)throw Error("Database not initialized");let t=this.db.prepare(`
      SELECT 
        w.*,
        COUNT(wlr.id) as total_readings,
        MAX(wlr.timestamp_utc) as last_reading_date,
        CASE WHEN COUNT(mr.id) > 0 THEN 1 ELSE 0 END as has_manual_readings,
        CASE WHEN COUNT(wlr.id) > 0 THEN 1 ELSE 0 END as has_transducer_data
      FROM wells w
      LEFT JOIN water_level_readings wlr ON w.well_number = wlr.well_number
      LEFT JOIN manual_readings mr ON w.well_number = mr.well_number
      WHERE w.well_number = ?
      GROUP BY w.well_number
    `);if(t.bind([e]),t.step()){let e=t.getAsObject();return t.free(),this.mapRowToWell(e)}return t.free(),null}async getWaterLevelData(e){if(!this.db)throw Error("Database not initialized");let{wellNumber:t,startDate:a,endDate:s,dataType:l="all",downsample:r=!1,maxPoints:i=1e3}=e,n=`
      SELECT 
        id,
        well_number,
        timestamp_utc,
        julian_timestamp,
        water_level,
        temperature,
        dtw,
        'transducer' as data_source,
        baro_flag,
        level_flag
      FROM water_level_readings
      WHERE well_number = ?
    `,o=[t];a&&(n+=" AND timestamp_utc >= ?",o.push(a)),s&&(n+=" AND timestamp_utc <= ?",o.push(s)),("all"===l||"manual"===l)&&(n+=` UNION ALL
        SELECT 
          id,
          well_number,
          timestamp_utc,
          julian_timestamp,
          water_level,
          NULL as temperature,
          dtw,
          'manual' as data_source,
          NULL as baro_flag,
          NULL as level_flag
        FROM manual_readings
        WHERE well_number = ?
      `,o.push(t),a&&(n+=" AND timestamp_utc >= ?",o.push(a)),s&&(n+=" AND timestamp_utc <= ?",o.push(s))),n+=" ORDER BY timestamp_utc";try{let e=this.db.prepare(n);e.bind(o);let t=[];for(;e.step();){let a=e.getAsObject();t.push(this.mapRowToReading(a))}if(e.free(),r&&t.length>i)return this.downsampleData(t,i);return t}catch(e){throw console.error("Error fetching water level data:",e),Error("Failed to fetch water level data")}}async getRechargeResults(e){if(!this.db)throw Error("Database not initialized");let t=this.db.prepare(`
      SELECT name FROM sqlite_master 
      WHERE type='table' AND name IN ('rise_results', 'mrc_results', 'emr_results')
    `),a=[];for(;t.step();){let e=t.getAsObject();a.push(e.name)}if(t.free(),0===a.length)return[];let s=[];for(let t of a){let a=t.replace("_results","").toUpperCase();try{let l=this.db.prepare(`
          SELECT * FROM ${t}
          WHERE well_number = ?
          ORDER BY calculation_date DESC
        `);for(l.bind([e]);l.step();){let e=l.getAsObject();s.push({...e,method:a,calculation_parameters:e.calculation_parameters?JSON.parse(e.calculation_parameters):void 0})}l.free()}catch(e){console.error(`Error querying ${t}:`,e)}}return s}mapRowToWell(e){return{well_number:e.well_number,cae_number:e.cae_number,well_field:e.well_field,cluster:e.cluster,latitude:e.latitude,longitude:e.longitude,top_of_casing:e.top_of_casing,ground_elevation:e.ground_elevation,well_depth:e.well_depth,screen_top:e.screen_top,screen_bottom:e.screen_bottom,aquifer_type:e.aquifer_type,static_water_level:e.static_water_level,notes:e.notes,last_reading_date:e.last_reading_date,total_readings:e.total_readings||0,has_manual_readings:!!e.has_manual_readings,has_transducer_data:!!e.has_transducer_data,has_telemetry_data:!!e.has_telemetry_data}}mapRowToReading(e){return{id:e.id,well_number:e.well_number,timestamp_utc:e.timestamp_utc,julian_timestamp:e.julian_timestamp,water_level:e.water_level,temperature:e.temperature,dtw:e.dtw,data_source:e.data_source,baro_flag:e.baro_flag,level_flag:e.level_flag,notes:e.notes}}downsampleData(e,t){if(e.length<=t)return e;let a=Math.floor(e.length/t),s=[];for(let t=0;t<e.length;t+=a)s.push(e[t]);return s[s.length-1]!==e[e.length-1]&&s.push(e[e.length-1]),s}close(){this.db&&(this.db.close(),this.db=null,this.initialized=!1)}}class o{async loadDatabase(e,t){let a=new n(t);return await a.initialize(),this.databases.set(e,a),a}getDatabase(e){return this.databases.get(e)||null}closeDatabase(e){let t=this.databases.get(e);t&&(t.close(),this.databases.delete(e))}closeAllDatabases(){for(let[e,t]of this.databases)t.close();this.databases.clear()}constructor(){this.databases=new Map}}let d=new o},2029:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r,metadata:()=>l});var s=a(9510);a(5023);let l={title:"Water Level Visualizer",description:"Mobile water level monitoring data visualization",keywords:["water level","monitoring","groundwater","visualization"],authors:[{name:"Water Level Monitoring Team"}],viewport:{width:"device-width",initialScale:1,maximumScale:1,userScalable:!1},themeColor:"#3b82f6",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"default",title:"Water Level Visualizer"},icons:{icon:"/favicon.ico",apple:"/apple-touch-icon.png"}};function r({children:e}){return(0,s.jsxs)("html",{lang:"en",children:[(0,s.jsxs)("head",{children:[s.jsx("meta",{name:"format-detection",content:"telephone=no"}),s.jsx("meta",{name:"mobile-web-app-capable",content:"yes"}),s.jsx("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),s.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),s.jsx("link",{rel:"preconnect",href:"https://sql.js.org"})]}),s.jsx("body",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"flex flex-col min-h-screen",children:[s.jsx("main",{className:"flex-1",children:e}),(0,s.jsxs)("footer",{className:"bg-white border-t border-gray-200 py-4 px-4 text-center text-sm text-gray-500",children:[s.jsx("p",{children:"Water Level Monitoring System"}),s.jsx("p",{className:"text-xs mt-1",children:"Mobile Visualizer v1.0"})]})]})})]})}},6990:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/Users/bmac/Documents/GitHub/water_levels_monitoring_(for_external_edits)/tools/Visualizer/src/app/wells/[id]/page.tsx#default`)},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[819],()=>a(964));module.exports=s})();